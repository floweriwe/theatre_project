"""
Константы приложения.

Централизованное хранение всех магических чисел и строк.
"""
from enum import Enum


# =============================================================================
# Token Types
# =============================================================================

class TokenType(str, Enum):
    """Типы JWT токенов."""
    
    ACCESS = "access"
    REFRESH = "refresh"


# =============================================================================
# Redis Keys Prefixes
# =============================================================================

class RedisPrefix(str, Enum):
    """Префиксы ключей Redis."""
    
    # Токены
    REFRESH_TOKEN = "refresh_token:"
    TOKEN_BLACKLIST = "token_blacklist:"
    
    # Кэш
    USER_CACHE = "user_cache:"
    PERMISSIONS_CACHE = "permissions_cache:"
    
    # Rate limiting
    RATE_LIMIT = "rate_limit:"


# =============================================================================
# Pagination
# =============================================================================

DEFAULT_PAGE_SIZE = 20
MAX_PAGE_SIZE = 100


# =============================================================================
# File Upload
# =============================================================================

# Максимальный размер файла (50 MB)
MAX_FILE_SIZE = 50 * 1024 * 1024

# Разрешённые расширения по категориям
ALLOWED_EXTENSIONS = {
    "document": {".pdf", ".doc", ".docx", ".odt", ".txt", ".rtf"},
    "spreadsheet": {".xlsx", ".xls", ".csv", ".ods"},
    "image": {".jpg", ".jpeg", ".png", ".gif", ".svg", ".webp"},
    "all": {".pdf", ".doc", ".docx", ".odt", ".txt", ".rtf",
            ".xlsx", ".xls", ".csv", ".ods",
            ".jpg", ".jpeg", ".png", ".gif", ".svg", ".webp"},
}

# MIME типы для просмотра
VIEWABLE_MIME_TYPES = {
    "application/pdf",
    "image/png",
    "image/jpeg",
    "image/gif",
    "image/svg+xml",
    "image/webp",
    "text/plain",
    "text/html",
    "text/csv",
}


# =============================================================================
# Password Requirements
# =============================================================================

PASSWORD_MIN_LENGTH = 8
PASSWORD_MAX_LENGTH = 128


# =============================================================================
# User Limits
# =============================================================================

# Количество неудачных попыток входа до блокировки
MAX_LOGIN_ATTEMPTS = 5

# Время блокировки после превышения попыток (секунды)
LOGIN_LOCKOUT_DURATION = 300  # 5 минут


# =============================================================================
# Cache TTL (Time To Live) in seconds
# =============================================================================

CACHE_TTL_SHORT = 60  # 1 минута
CACHE_TTL_MEDIUM = 300  # 5 минут
CACHE_TTL_LONG = 3600  # 1 час
CACHE_TTL_DAY = 86400  # 24 часа
