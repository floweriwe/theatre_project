FROM node:20-alpine
WORKDIR /app

# Кэш npm
RUN mkdir -p /root/.npm

# Копируем только package files (для кэширования слоя)
COPY package*.json ./

# npm ci быстрее чем npm install
RUN npm ci \
    --prefer-offline \
    --no-audit \
    --cache /root/.npm \
    --loglevel=error

# НЕ копируем исходники - они монтируются через volume!

EXPOSE 5173
CMD ["npm", "run", "dev", "--", "--host", "0.0.0.0"]