# Theatre Management System ‚Äî –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

## üèóÔ∏è –û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                              NGINX (Reverse Proxy)                           ‚îÇ
‚îÇ                           Port 80/443 (production)                           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                ‚îÇ                                            ‚îÇ
‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ   ‚îÇ   Frontend (React)     ‚îÇ   ‚îÇ   ‚îÇ      API Gateway (FastAPI)         ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   Port: 5173 (dev)     ‚îÇ   ‚îÇ   ‚îÇ      Port: 8000                    ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   Static files (prod)  ‚îÇ   ‚îÇ   ‚îÇ      /api/v1/*                     ‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                ‚îÇ                  ‚îÇ                         ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                        INTERNAL SERVICE MESH                                ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îÇ
‚îÇ  ‚îÇAuth Service ‚îÇ ‚îÇ Inventory   ‚îÇ ‚îÇPerformances ‚îÇ ‚îÇ Schedule    ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ  (internal) ‚îÇ ‚îÇ  Service    ‚îÇ ‚îÇ  Service    ‚îÇ ‚îÇ  Service    ‚îÇ           ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îÇ
‚îÇ         ‚îÇ               ‚îÇ               ‚îÇ               ‚îÇ                   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îÇ
‚îÇ  ‚îÇ Documents    ‚îÇ ‚îÇ  Tasks    ‚îÇ ‚îÇ Notifications ‚îÇ ‚îÇ  Files    ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ  Service     ‚îÇ ‚îÇ  Service  ‚îÇ ‚îÇ   Service     ‚îÇ ‚îÇ  Service  ‚îÇ           ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                           DATA LAYER                                        ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                ‚îÇ
‚îÇ  ‚îÇ   PostgreSQL   ‚îÇ  ‚îÇ     Redis      ‚îÇ  ‚îÇ     MinIO      ‚îÇ                ‚îÇ
‚îÇ  ‚îÇ   Port: 5432   ‚îÇ  ‚îÇ   Port: 6379   ‚îÇ  ‚îÇ   Port: 9000   ‚îÇ                ‚îÇ
‚îÇ  ‚îÇ   (Primary DB) ‚îÇ  ‚îÇ (Cache/Queue)  ‚îÇ  ‚îÇ  (File Store)  ‚îÇ                ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üì¶ –°–µ—Ä–≤–∏—Å—ã

### 1. API Gateway

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤

```python
# –†–æ—É—Ç–∏–Ω–≥
/api/v1/auth/*        ‚Üí Auth Service
/api/v1/inventory/*   ‚Üí Inventory Service
/api/v1/performances/* ‚Üí Performances Service
/api/v1/schedule/*    ‚Üí Schedule Service
/api/v1/documents/*   ‚Üí Documents Service
/api/v1/tasks/*       ‚Üí Tasks Service
/api/v1/notifications/* ‚Üí Notifications Service
/api/v1/files/*       ‚Üí Files Service
```

**–§—É–Ω–∫—Ü–∏–∏**:
- JWT –≤–∞–ª–∏–¥–∞—Ü–∏—è
- Rate limiting
- Request logging
- CORS handling
- Error transformation

### 2. Auth Service

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã**:
```
POST /auth/login          # –í—Ö–æ–¥
POST /auth/refresh        # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
POST /auth/logout         # –í—ã—Ö–æ–¥
GET  /auth/me             # –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
```

**–ú–æ–¥–µ–ª–∏**:
- User
- UserRole
- RefreshToken

### 3. Inventory Service

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—ë–º

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã**:
```
GET    /inventory                    # –°–ø–∏—Å–æ–∫ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π –∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
GET    /inventory/{id}               # –î–µ—Ç–∞–ª–∏ –ø—Ä–µ–¥–º–µ—Ç–∞
POST   /inventory                    # –°–æ–∑–¥–∞–Ω–∏–µ
PUT    /inventory/{id}               # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
DELETE /inventory/{id}               # –£–¥–∞–ª–µ–Ω–∏–µ (soft delete)
GET    /inventory/{id}/history       # –ò—Å—Ç–æ—Ä–∏—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π
GET    /inventory/{id}/schedule      # –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
GET    /inventory/categories         # –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
GET    /inventory/locations          # –õ–æ–∫–∞—Ü–∏–∏
POST   /inventory/{id}/photos        # –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ
GET    /inventory/analytics          # –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
```

### 4. Performances Service

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –°–ø–µ–∫—Ç–∞–∫–ª–∏ –∏ –ø–∞—Å–ø–æ—Ä—Ç–∞

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã**:
```
GET    /performances                  # –°–ø–∏—Å–æ–∫ —Å–ø–µ–∫—Ç–∞–∫–ª–µ–π
GET    /performances/{id}             # –î–µ—Ç–∞–ª–∏ —Å–ø–µ–∫—Ç–∞–∫–ª—è
POST   /performances                  # –°–æ–∑–¥–∞–Ω–∏–µ
PUT    /performances/{id}             # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
DELETE /performances/{id}             # –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ

# –ü–∞—Å–ø–æ—Ä—Ç —Å–ø–µ–∫—Ç–∞–∫–ª—è
GET    /performances/{id}/passport              # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞—Å–ø–æ—Ä—Ç–∞
GET    /performances/{id}/passport/sections     # –†–∞–∑–¥–µ–ª—ã
POST   /performances/{id}/passport/sections     # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞
PUT    /performances/{id}/passport/sections/{section_id}

# –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å —Å–ø–µ–∫—Ç–∞–∫–ª—è
GET    /performances/{id}/inventory             # –ü—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
POST   /performances/{id}/inventory             # –ü—Ä–∏–≤—è–∑–∫–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
DELETE /performances/{id}/inventory/{item_id}   # –û—Ç–≤—è–∑–∫–∞

# –ß–µ–∫–ª–∏—Å—Ç—ã
GET    /performances/{id}/checklists            # –ß–µ–∫–ª–∏—Å—Ç—ã –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
POST   /performances/{id}/checklists            # –°–æ–∑–¥–∞–Ω–∏–µ —á–µ–∫–ª–∏—Å—Ç–∞
PUT    /performances/{id}/checklists/{checklist_id}
```

### 5. Schedule Service

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∏ —Å–æ–±—ã—Ç–∏—è

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã**:
```
GET    /schedule                      # –°–æ–±—ã—Ç–∏—è —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –ø–æ –¥–∞—Ç–∞–º
GET    /schedule/{id}                 # –î–µ—Ç–∞–ª–∏ —Å–æ–±—ã—Ç–∏—è
POST   /schedule                      # –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
PUT    /schedule/{id}                 # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
DELETE /schedule/{id}                 # –£–¥–∞–ª–µ–Ω–∏–µ

# –£—á–∞—Å—Ç–Ω–∏–∫–∏
GET    /schedule/{id}/participants    # –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
POST   /schedule/{id}/participants    # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞
DELETE /schedule/{id}/participants/{user_id}
PUT    /schedule/{id}/participants/{user_id}/status  # –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞

# –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É—á–∞—Å—Ç–∏—è
POST   /schedule/{id}/confirm         # –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É—á–∞—Å—Ç–∏–µ
POST   /schedule/{id}/decline         # –û—Ç–∫–ª–æ–Ω–∏—Ç—å —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º

# –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã
GET    /schedule/conflicts            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
GET    /schedule/availability         # –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–ª–æ—â–∞–¥–∫–∏/—É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

# –ü–ª–æ—â–∞–¥–∫–∏
GET    /schedule/venues               # –°–ø–∏—Å–æ–∫ –ø–ª–æ—â–∞–¥–æ–∫
```

### 6. Documents Service

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã**:
```
GET    /documents                     # –°–ø–∏—Å–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
GET    /documents/{id}                # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
POST   /documents                     # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
PUT    /documents/{id}                # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
DELETE /documents/{id}                # –£–¥–∞–ª–µ–Ω–∏–µ
GET    /documents/{id}/download       # –°–∫–∞—á–∏–≤–∞–Ω–∏–µ
GET    /documents/{id}/preview        # –ü—Ä–µ–≤—å—é (–¥–ª—è PDF/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)

# –í–µ—Ä—Å–∏–∏
GET    /documents/{id}/versions       # –ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π
POST   /documents/{id}/versions       # –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏
GET    /documents/{id}/versions/{version_id}/download

# –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
GET    /documents/categories          # –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
```

### 7. Tasks Service

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –ó–∞–¥–∞—á–∏ –∏ –ø–æ–¥–∑–∞–¥–∞—á–∏

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã**:
```
GET    /tasks                         # –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
GET    /tasks/{id}                    # –î–µ—Ç–∞–ª–∏ –∑–∞–¥–∞—á–∏
POST   /tasks                         # –°–æ–∑–¥–∞–Ω–∏–µ
PUT    /tasks/{id}                    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
DELETE /tasks/{id}                    # –£–¥–∞–ª–µ–Ω–∏–µ
PUT    /tasks/{id}/status             # –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞

# –ü–æ–¥–∑–∞–¥–∞—á–∏ (—á–µ–∫–ª–∏—Å—Ç –≤–Ω—É—Ç—Ä–∏ –∑–∞–¥–∞—á–∏)
GET    /tasks/{id}/subtasks
POST   /tasks/{id}/subtasks
PUT    /tasks/{id}/subtasks/{subtask_id}
DELETE /tasks/{id}/subtasks/{subtask_id}

# –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
GET    /tasks/{id}/comments
POST   /tasks/{id}/comments
```

### 8. Notifications Service

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: In-app —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã**:
```
GET    /notifications                 # –°–ø–∏—Å–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
GET    /notifications/unread-count    # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö
PUT    /notifications/{id}/read       # –û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ
PUT    /notifications/read-all        # –û—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
DELETE /notifications/{id}            # –£–¥–∞–ª–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
GET    /notifications/settings        # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
PUT    /notifications/settings        # –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```

### 9. Files Service

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ (MinIO)

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã**:
```
POST   /files/upload                  # –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
GET    /files/{id}                    # –°–∫–∞—á–∏–≤–∞–Ω–∏–µ
GET    /files/{id}/thumbnail          # –ü—Ä–µ–≤—å—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
DELETE /files/{id}                    # –£–¥–∞–ª–µ–Ω–∏–µ
```

---

## üóÑÔ∏è Data Layer

### PostgreSQL

**–û—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**

```yaml
Version: 16+
Port: 5432
Databases:
  - theatre_main     # –û—Å–Ω–æ–≤–Ω–∞—è –ë–î
  - theatre_test     # –¢–µ—Å—Ç–æ–≤–∞—è –ë–î

Extensions:
  - uuid-ossp        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è UUID
  - pgcrypto         # –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
```

### Redis

**–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—á–µ—Ä–µ–¥–∏**

```yaml
Version: 7+
Port: 6379
Usage:
  - Session storage (JWT refresh tokens)
  - Cache (—Å–ø–∏—Å–∫–∏, —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏)
  - Rate limiting counters
  - Pub/Sub –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
  
Key patterns:
  - session:{user_id}           # –°–µ—Å—Å–∏–∏
  - cache:inventory:list        # –ö—ç—à —Å–ø–∏—Å–∫–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
  - cache:categories            # –ö—ç—à –∫–∞—Ç–µ–≥–æ—Ä–∏–π
  - ratelimit:{ip}:{endpoint}   # Rate limiting
  - notifications:{user_id}     # –û—á–µ—Ä–µ–¥—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
```

### MinIO

**–§–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (S3-compatible)**

```yaml
Version: latest
Port: 9000 (API), 9001 (Console)

Buckets:
  - theatre-documents    # –î–æ–∫—É–º–µ–Ω—Ç—ã
  - theatre-photos       # –§–æ—Ç–æ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
  - theatre-media        # –ê—É–¥–∏–æ/–≤–∏–¥–µ–æ
  - theatre-temp         # –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
  
–°—Ç—Ä—É–∫—Ç—É—Ä–∞:
  theatre-photos/
    ‚îú‚îÄ‚îÄ inventory/
    ‚îÇ   ‚îú‚îÄ‚îÄ {inventory_id}/
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.jpg
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ thumb.jpg
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ {photo_id}.jpg
    
  theatre-documents/
    ‚îú‚îÄ‚îÄ performances/
    ‚îÇ   ‚îú‚îÄ‚îÄ {performance_id}/
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ passport/
    ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 1.0/{files}
    ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 2.0/{files}
    ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ 3.0/{files}
    ‚îú‚îÄ‚îÄ general/
    ‚îÇ   ‚îî‚îÄ‚îÄ {document_id}/
```

---

## üê≥ Docker Compose

### Development (docker-compose.dev.yml)

```yaml
version: '3.8'

services:
  # Frontend
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile.dev
    ports:
      - "5173:5173"
    volumes:
      - ./frontend/src:/app/src
      - ./frontend/public:/app/public
    environment:
      - VITE_API_URL=http://localhost:8000/api/v1
    depends_on:
      - backend

  # Backend (API Gateway + Services)
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile.dev
    ports:
      - "8000:8000"
    volumes:
      - ./backend/app:/app/app
      - ./backend/alembic:/app/alembic
    environment:
      - DATABASE_URL=postgresql+asyncpg://theatre:theatre@postgres:5432/theatre_main
      - REDIS_URL=redis://redis:6379/0
      - MINIO_ENDPOINT=minio:9000
      - MINIO_ACCESS_KEY=minioadmin
      - MINIO_SECRET_KEY=minioadmin
      - JWT_SECRET_KEY=dev-secret-key-change-in-production
      - CORS_ORIGINS=http://localhost:5173,http://localhost:3000
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      minio:
        condition: service_started
    command: >
      sh -c "alembic upgrade head && 
             uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload"

  # PostgreSQL
  postgres:
    image: postgres:16-alpine
    ports:
      - "5432:5432"
    environment:
      - POSTGRES_USER=theatre
      - POSTGRES_PASSWORD=theatre
      - POSTGRES_DB=theatre_main
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./backend/scripts/init-db.sql:/docker-entrypoint-initdb.d/init-db.sql
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U theatre -d theatre_main"]
      interval: 5s
      timeout: 5s
      retries: 5

  # Redis
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 5s
      timeout: 5s
      retries: 5

  # MinIO
  minio:
    image: minio/minio:latest
    ports:
      - "9000:9000"
      - "9001:9001"
    environment:
      - MINIO_ROOT_USER=minioadmin
      - MINIO_ROOT_PASSWORD=minioadmin
    volumes:
      - minio_data:/data
    command: server /data --console-address ":9001"

  # MinIO setup (—Å–æ–∑–¥–∞–Ω–∏–µ –±–∞–∫–µ—Ç–æ–≤)
  minio-setup:
    image: minio/mc:latest
    depends_on:
      - minio
    entrypoint: >
      /bin/sh -c "
      sleep 5;
      mc alias set myminio http://minio:9000 minioadmin minioadmin;
      mc mb myminio/theatre-documents --ignore-existing;
      mc mb myminio/theatre-photos --ignore-existing;
      mc mb myminio/theatre-media --ignore-existing;
      mc mb myminio/theatre-temp --ignore-existing;
      mc anonymous set download myminio/theatre-photos;
      exit 0;
      "

volumes:
  postgres_data:
  redis_data:
  minio_data:

networks:
  default:
    name: theatre-network
```

### Production (docker-compose.prod.yml)

```yaml
version: '3.8'

services:
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./frontend/dist:/usr/share/nginx/html:ro
      - ./ssl:/etc/nginx/ssl:ro
    depends_on:
      - backend

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile.prod
    # –í production frontend —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏ —Ä–∞–∑–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ nginx

  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile.prod
    expose:
      - "8000"
    environment:
      - DATABASE_URL=${DATABASE_URL}
      - REDIS_URL=${REDIS_URL}
      - MINIO_ENDPOINT=${MINIO_ENDPOINT}
      - MINIO_ACCESS_KEY=${MINIO_ACCESS_KEY}
      - MINIO_SECRET_KEY=${MINIO_SECRET_KEY}
      - JWT_SECRET_KEY=${JWT_SECRET_KEY}
    depends_on:
      - postgres
      - redis
      - minio
    deploy:
      replicas: 2
      restart_policy:
        condition: on-failure

  postgres:
    image: postgres:16-alpine
    environment:
      - POSTGRES_USER=${POSTGRES_USER}
      - POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
      - POSTGRES_DB=${POSTGRES_DB}
    volumes:
      - postgres_data:/var/lib/postgresql/data
    deploy:
      placement:
        constraints:
          - node.role == manager

  redis:
    image: redis:7-alpine
    volumes:
      - redis_data:/data
    command: redis-server --appendonly yes

  minio:
    image: minio/minio:latest
    environment:
      - MINIO_ROOT_USER=${MINIO_ROOT_USER}
      - MINIO_ROOT_PASSWORD=${MINIO_ROOT_PASSWORD}
    volumes:
      - minio_data:/data
    command: server /data

volumes:
  postgres_data:
  redis_data:
  minio_data:
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
theatre-management-system/
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ docker-compose.dev.yml
‚îú‚îÄ‚îÄ docker-compose.prod.yml
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ README.md
‚îÇ
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile.dev
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile.prod
‚îÇ   ‚îú‚îÄ‚îÄ pyproject.toml
‚îÇ   ‚îú‚îÄ‚îÄ alembic.ini
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ alembic/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ env.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ versions/
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.py                 # FastAPI application
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py               # Settings (Pydantic)
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deps.py             # Dependencies (get_db, get_current_user)
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ v1/
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ router.py       # Main router
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ auth.py
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ inventory.py
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ performances.py
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ schedule.py
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ documents.py
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ tasks.py
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ notifications.py
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ files.py
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security.py         # JWT, password hashing
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ permissions.py      # RBAC
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ exceptions.py       # Custom exceptions
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ constants.py        # Enums, constants
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py             # Base model
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ session.py          # Session factory
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inventory.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ performance.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schedule.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ document.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ task.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ notification.py
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schemas/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inventory.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ performance.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schedule.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ document.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ task.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ notification.py
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user_repository.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inventory_repository.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ performance_repository.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schedule_repository.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ document_repository.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ task_repository.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ notification_repository.py
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth_service.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inventory_service.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ performance_service.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schedule_service.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ document_service.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ task_service.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ notification_service.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ file_service.py       # MinIO operations
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ redis_service.py      # Cache operations
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ helpers.py
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ init_db.py              # Initialize DB + seed data
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ seed_data.py            # Generate test data
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ create_superuser.py
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ tests/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ conftest.py
‚îÇ       ‚îú‚îÄ‚îÄ test_auth.py
‚îÇ       ‚îú‚îÄ‚îÄ test_inventory.py
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile.dev
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile.prod
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îú‚îÄ‚îÄ vite.config.ts
‚îÇ   ‚îú‚îÄ‚îÄ tsconfig.json
‚îÇ   ‚îú‚îÄ‚îÄ tailwind.config.js
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ src/
‚îÇ       ‚îú‚îÄ‚îÄ main.tsx
‚îÇ       ‚îú‚îÄ‚îÄ App.tsx
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ assets/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ fonts/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ images/
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ components/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ ui/                 # UI-kit
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Button.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Card.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Modal.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Input.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Select.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Table.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Tabs.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Calendar.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Toast.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Skeleton.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Badge.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dropdown.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ   ‚îÇ
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ layout/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MainLayout.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Sidebar.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Header.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ   ‚îÇ
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ features/
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ inventory/
‚îÇ       ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ InventoryCard.tsx
‚îÇ       ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ InventoryFilters.tsx
‚îÇ       ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ InventoryGrid.tsx
‚îÇ       ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ       ‚îÇ
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ schedule/
‚îÇ       ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ CalendarView.tsx
‚îÇ       ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ EventCard.tsx
‚îÇ       ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ EventFormModal.tsx
‚îÇ       ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ       ‚îÇ
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ tasks/
‚îÇ       ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ TaskCard.tsx
‚îÇ       ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ TaskChecklist.tsx
‚îÇ       ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ       ‚îÇ
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ notifications/
‚îÇ       ‚îÇ           ‚îú‚îÄ‚îÄ NotificationCenter.tsx
‚îÇ       ‚îÇ           ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ pages/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ auth/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoginPage.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ   ‚îÇ
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DashboardPage.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ   ‚îÇ
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ inventory/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ InventoryListPage.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ InventoryItemPage.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ InventoryFormPage.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ   ‚îÇ
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ performances/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PerformancesListPage.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PerformanceViewPage.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PerformanceFormPage.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PassportPage.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ   ‚îÇ
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ schedule/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SchedulePage.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ   ‚îÇ
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ documents/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DocumentsListPage.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DocumentViewPage.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ   ‚îÇ
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ tasks/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TasksListPage.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TaskDetailPage.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ   ‚îÇ
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ admin/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UsersListPage.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UserDetailPage.tsx
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ   ‚îÇ
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ error/
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ NotFoundPage.tsx
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ services/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ api.ts              # Axios instance
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ auth_service.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ inventory_service.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ performance_service.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ schedule_service.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ document_service.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ task_service.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ notification_service.ts
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ store/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ authStore.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ uiStore.ts
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ hooks/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ useAuth.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ useInventory.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ useNotifications.ts
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ types/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ auth_types.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ inventory_types.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ performance_types.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ schedule_types.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ document_types.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ task_types.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ notification_types.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ common_types.ts
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ utils/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ cn.ts               # classnames helper
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ constants.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ helpers.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ formatters.ts
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îÇ
‚îÇ       ‚îî‚îÄ‚îÄ styles/
‚îÇ           ‚îî‚îÄ‚îÄ globals.css
‚îÇ
‚îú‚îÄ‚îÄ nginx/
‚îÇ   ‚îî‚îÄ‚îÄ nginx.conf
‚îÇ
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ README.md
‚îÇ   ‚îú‚îÄ‚îÄ architecture/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ README.md
‚îÇ   ‚îî‚îÄ‚îÄ deployment/
‚îÇ       ‚îî‚îÄ‚îÄ README.md
‚îÇ
‚îî‚îÄ‚îÄ scripts/
    ‚îú‚îÄ‚îÄ init_all.sh
    ‚îú‚îÄ‚îÄ backup.sh
    ‚îî‚îÄ‚îÄ test_all.sh
```

---

## üîÑ –ü–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –ø—Ä–∞–∫—Ç–∏–∫–∏

### Repository Pattern

```python
# backend/app/repositories/base.py
from typing import Generic, TypeVar, Type, Optional, List
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy import select, update, delete

ModelType = TypeVar("ModelType")

class BaseRepository(Generic[ModelType]):
    def __init__(self, model: Type[ModelType], session: AsyncSession):
        self.model = model
        self.session = session
    
    async def get(self, id: UUID) -> Optional[ModelType]:
        result = await self.session.execute(
            select(self.model).where(self.model.id == id)
        )
        return result.scalar_one_or_none()
    
    async def get_all(self, skip: int = 0, limit: int = 100) -> List[ModelType]:
        result = await self.session.execute(
            select(self.model).offset(skip).limit(limit)
        )
        return result.scalars().all()
    
    async def create(self, obj_in: dict) -> ModelType:
        db_obj = self.model(**obj_in)
        self.session.add(db_obj)
        await self.session.commit()
        await self.session.refresh(db_obj)
        return db_obj
    
    async def update(self, id: UUID, obj_in: dict) -> Optional[ModelType]:
        await self.session.execute(
            update(self.model).where(self.model.id == id).values(**obj_in)
        )
        await self.session.commit()
        return await self.get(id)
    
    async def delete(self, id: UUID) -> bool:
        await self.session.execute(
            delete(self.model).where(self.model.id == id)
        )
        await self.session.commit()
        return True
```

### Service Layer

```python
# backend/app/services/inventory_service.py
from app.repositories.inventory_repository import InventoryRepository
from app.services.file_service import FileService
from app.services.notification_service import NotificationService

class InventoryService:
    def __init__(
        self,
        repository: InventoryRepository,
        file_service: FileService,
        notification_service: NotificationService
    ):
        self.repository = repository
        self.file_service = file_service
        self.notification_service = notification_service
    
    async def create_item(self, data: InventoryCreate, user_id: UUID):
        # Business logic here
        item = await self.repository.create(data.dict())
        
        # Upload photos if provided
        if data.photos:
            for photo in data.photos:
                await self.file_service.upload_inventory_photo(item.id, photo)
        
        return item
    
    async def get_item_with_schedule(self, item_id: UUID):
        item = await self.repository.get(item_id)
        schedule = await self.repository.get_usage_schedule(item_id)
        return {**item.__dict__, "schedule": schedule}
```

### Dependency Injection

```python
# backend/app/api/deps.py
from fastapi import Depends
from sqlalchemy.ext.asyncio import AsyncSession
from app.database.session import get_session
from app.repositories.inventory_repository import InventoryRepository
from app.services.inventory_service import InventoryService

async def get_inventory_repository(
    session: AsyncSession = Depends(get_session)
) -> InventoryRepository:
    return InventoryRepository(session)

async def get_inventory_service(
    repo: InventoryRepository = Depends(get_inventory_repository),
    file_service: FileService = Depends(get_file_service),
    notification_service: NotificationService = Depends(get_notification_service)
) -> InventoryService:
    return InventoryService(repo, file_service, notification_service)
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### JWT Authentication

```python
# Token structure
{
    "sub": "user_id",
    "role": "technical_director",
    "department": "light",  # –µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ
    "exp": 1234567890,
    "iat": 1234567800
}

# Access token: 15 –º–∏–Ω—É—Ç
# Refresh token: 7 –¥–Ω–µ–π (—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ Redis)
```

### RBAC (Role-Based Access Control)

```python
# backend/app/core/permissions.py
from enum import Enum
from functools import wraps

class Permission(Enum):
    # Inventory
    INVENTORY_READ = "inventory:read"
    INVENTORY_CREATE = "inventory:create"
    INVENTORY_UPDATE = "inventory:update"
    INVENTORY_DELETE = "inventory:delete"
    
    # Performances
    PERFORMANCE_READ = "performance:read"
    PERFORMANCE_CREATE = "performance:create"
    PERFORMANCE_UPDATE = "performance:update"
    
    # Schedule
    SCHEDULE_READ = "schedule:read"
    SCHEDULE_CREATE = "schedule:create"
    SCHEDULE_UPDATE = "schedule:update"
    
    # Tasks
    TASK_READ = "task:read"
    TASK_CREATE = "task:create"
    TASK_EXECUTE = "task:execute"
    
    # Admin
    USER_MANAGE = "user:manage"

ROLE_PERMISSIONS = {
    "admin": [Permission.USER_MANAGE, ...all permissions...],
    "technical_director": [...],
    "assistant_director": [...],
    "department_head": [...],
    "department_staff": [...],
    "actor": [Permission.SCHEDULE_READ, ...]
}
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–¥–ª—è production)

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å—Ç–µ–∫

- **Prometheus** ‚Äî –º–µ—Ç—Ä–∏–∫–∏
- **Grafana** ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
- **Loki** ‚Äî –ª–æ–≥–∏
- **Sentry** ‚Äî error tracking

### Health checks

```python
# backend/app/api/v1/health.py
@router.get("/health")
async def health_check(
    db: AsyncSession = Depends(get_session),
    redis: Redis = Depends(get_redis)
):
    return {
        "status": "healthy",
        "database": await check_db(db),
        "redis": await check_redis(redis),
        "minio": await check_minio()
    }
```

---

*–î–æ–∫—É–º–µ–Ω—Ç –æ–±–Ω–æ–≤–ª—ë–Ω: –Ø–Ω–≤–∞—Ä—å 2026*
*–í–µ—Ä—Å–∏—è: 1.0*
